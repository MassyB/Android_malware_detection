# module qui va contenir le code "métier" relatif à la bdd

from db_context_managers import OpenReaderCursor, OpenWriterCursor

_SQL_get_api_permissions = """ SELECT permission
                                   FROM api_permission_mapping
                                   WHERE api = %s """


def get_api_permissions(api: str) -> list:
    with OpenReaderCursor(_SQL_get_api_permissions, (api,)) as cursor:
        return [permission[0] for permission in cursor.fetchall()]


