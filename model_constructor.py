import csv
import numpy as np
from sklearn.svm import LinearSVC


def get_features_weights(linearSVC: 'LinearSVC', vector_space_dict: dict) -> dict:
    coefs = linearSVC.coef_
    features = np.sort(vector_space_dict.keys())
    feature_weight_dict = {feature: coef for feature, coef in zip(features, coefs)}
    feature_weight_dict['_intercept'] = linearSVC.intercept_

    return feature_weight_dict


def get_features_weights_csv(linearSVC: 'LinearSVC', vector_space_dict: dict, csv_name='feature_weight.csv'):
    with open(csv_name, 'w') as f:
        writer = csv.writer(f)
        writer.writerow(('feature', 'weight'))
        rows = [(feature, weight) for feature, weight in get_features_weights(linearSVC, vector_space_dict)]
        writer.writerows(rows)
