from apk import APK
from feature_extractor_dex import extract_dex_features
from feature_extractor_manifest import extract_manifest_features

apk = APK('hello', 'datasets/malwares/0a0a78000e418ea28fa02e8c162c43396db6141ef8fe876db4027fef04bed663')
extract_dex_features(apk)
extract_manifest_features(apk)

print(apk.get_features(1))
print(len(apk.get_features(1)))

print('restricted apis:',len(apk.get_dex_features().get_restricted_apis()))
print('suspicious_apis:',len(apk.get_dex_features().get_suspicious_apis()))
print('url:',len(apk.get_dex_features().get_url()))
print('used_permission:',len(apk.get_dex_features().get_used_permissions()))



print('hardwares:', len(apk.get_manifest_features().get_hardware()))
print('defined permissions:',len(apk.get_manifest_features().get_permissions()))
print('components:',len(apk.get_manifest_features().get_components()))
print('intents:',len(apk.get_manifest_features().get_intents()))