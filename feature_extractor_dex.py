from apk import APK
from dex_extractor import extract_url, extract_api_call, extract_methode_path
from apis_manager import is_suspicious, is_restricted, get_required_permissions


def extract_restricted_api(apk: 'APK', smali_line: str):
    api_call = extract_api_call(smali_line)
    if is_restricted(api_call):
        apk.add_restricted_api(api_call)


def extract_used_permissions(apk: 'APK', smali_line: str):
    api_call = extract_api_call(smali_line)
    if is_restricted(api_call):
        apk.add_used_permissions(get_required_permissions(api_call))


def extract_suspicious_api(apk: 'APK', smali_line: str):
    method_path = extract_methode_path(smali_line)
    if is_suspicious(method_path):
        api_call = extract_api_call(smali_line)
        apk.add_suspicious_api(api_call)


def extract_network_adress(apk: 'APK', smali_line: str):
    url = extract_url(smali_line)
    if url:
        apk.add_url(url)

