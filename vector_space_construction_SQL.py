_SQL_get_features_by_type = """select distinct name
                               from features
                               where type = :type"""

_SQL_get_features_counting_by_type = """select name, count(name) as count
                                        from features
                                        where type = :type
                                              AND apk_id in (select id from apks where malignity = 1)
                                        group by name
                                        order by count desc"""

_SQL_get_features_ratio_by_type = """SELECT malwares.name, malwares.count, cast (count AS FLOAT) /total
                                     FROM
	                                  (SELECT name, count(name) AS count
		                               FROM features
		                               WHERE type = :type
		                                     AND apk_id IN (SELECT id FROM apks WHERE malignity = 1)
		                               GROUP BY name) AS malwares
	                                 JOIN
	                                    (SELECT name, count(name) AS total
                                         FROM features
                                         WHERE type= :type
                                         GROUP BY name) AS apps
                                    ON malwares.name = apps.name"""

_SQL_get_features_by_ratio ="""SELECT malwares.name, malwares.count, cast (count AS FLOAT) /total AS proportion
                               FROM
                                  (SELECT name, count(name) AS count
                                   FROM features
                                   WHERE type = :type
                                         AND apk_id IN (SELECT id FROM apks WHERE malignity = 1)
                                   GROUP BY name) AS malwares
	                           JOIN
                                  (SELECT name, count(name) AS total
                                   FROM features
                                   WHERE type= :type
                                   GROUP BY name) AS apps
                               ON malwares.name = apps.name
                               WHERE proportion >= :proportion"""


