class APK:
    def __init__(self, name: str, path: str, malignity: int):
        self.manifest_features = ManifestFeatures()
        self.dex_features = DexFeatures()
        self.malignity = malignity
        self.name = name
        self.path = path
        self.score = None

    def set_manifest_features(self, manifest_features):
        if type(manifest_features) == ManifestFeatures:
            self.manifest_features = manifest_features

    def set_dex_features(self, dex_features):
        if type(dex_features) == DexFeatures:
            self.dex_features = dex_features

    def get_manifest_features(self):
        return self.manifest_features

    def get_dex_features(self):
        return self.dex_features

    def add_restricted_api(self,api_call):
        self.dex_features.add_restricted_api(api_call)

    def add_suspicious_api(self, api_call):
        self.dex_features.add_suspicious_api(api_call)

    def add_used_permissions(self, permissions):
        self.dex_features.add_used_permissions(permissions)

    def add_url(self,url):
        self.dex_features.add_url(url)

    def add_defined_permissions(self, permissions):
        self.manifest_features.add_permissions(permissions)

    def add_components(self, components):
        self.manifest_features.add_components(components)

    def add_hardwares(self, hardwares):
        self.manifest_features.add_hardwares(hardwares)

    def add_intents(self, intents):
        self.manifest_features.add_intents(intents)

class DexFeatures:
    def __init__(self):
        self.restricted_apis = set()
        self.used_permissions = set()
        self.suspicious_apis = set()
        self.urls = set()

    def get_restricted_apis(self):
        return self.restricted_apis

    def get_used_permissions(self):
        return self.used_permissions

    def get_suspicious_apis(self):
        return self.suspicious_apis

    def get_url(self):
        return self.urls

    def add_restricted_api(self, api: str):
        self.restricted_apis.add(api)

    def add_used_permissions(self, permissions: list):
        self.used_permissions.add(permissions)

    def add_suspicious_api(self, api: str):
        self.suspicious_apis.add(api)

    def add_url(self, url: str):
        self.urls.add(url)


class ManifestFeatures:
    def __init__(self):
        self.permissions = set()
        self.hardware = set()
        self.intents = set()
        self.components = set()

    def get_components(self):
        return self.permissions

    def get_hardware(self):
        return self.hardware

    def get_intents(self):
        return self.intents

    def get_permissions(self):
        return self.permissions

    def add_permissions(self, permissions):
        self.permissions.add(permissions)

    def add_components(self, components):
        self.components.add(components)

    def add_hardwares(self,hardwares):
        self.hardware.add(hardwares)

    def add_intents(self, intents):
        self.intents.add(intents)